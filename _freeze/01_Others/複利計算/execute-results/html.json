{
  "hash": "1ffe6a64466a07c78b1afaa05bf46465",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 複利計算\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n## 複利計算\n\n\\begin{align*}\n& 1年目:ar^1 \\\\ \n& 2年目:ar^1 + ar^2 \\\\\n& 3年目:ar^1 + ar^2 + ar^3 \\\\\n& n年目:\\sum_{i=1}^{n} ar^i = \\frac{ar(1 - r^n)}{1 - r}\n\\end{align*}\n\n- 等比級数の和の導出\n\n\\begin{align*}\nS =& ar + ar^2 + ar^3 + ... + ar^n \\\\\nrS =& \\qquad\\; ar^2 + ar^3 + ... + ar^n + ar^{n+1} \\\\\nS - rS =& ar - ar^{n+1} \\\\\nS(1 - r) =& ar(1 - r^n) \\\\\nS =& \\frac{ar(1 - r^n)}{1 - r}\n\\end{align*}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- 30\na <- 40\nr <- 1.05\n\ntibble(\n  n = 1:n,\n  cost = a*n,\n  gain = a*r^n,\n  return = a*r*(1 - r^n)/(1 - r),\n) |> \n  ggplot()+\n  geom_line(aes(x = n, y = return), color = 'red')+\n  geom_col(aes(x = n, y = cost), alpha = .7)+\n  geom_line(aes(x = n, y = cost), color = 'blue')\n```\n\n::: {.cell-output-display}\n![](複利計算_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n## 利率が年度ごとに変動する場合\n\n\\begin{align*}\n& 1年目:ar_1 \\\\\n& 2年目:ar_1 + ar_1r_2\\\\\n& 3年目:ar_1 + ar_1r_2 + ar_1r_2r_3 = a(r_1 + r_1r_2 + r_1r_2r_3)\\\\\n& n年目:ar_1 + ar_1r_2 + ar_1r_2r_3 + ... + ar_1r_2r_3...r_n = a\\sum_{i=1}^{n} \\prod_{i=1}^{n}r_i\n\\end{align*}\n\nここで、$r_i \\sim \\mathrm{Normal}(1.05, 0.1)$とする\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(\n  n = 1:n,\n  r = rnorm(n, r, .2),\n  cost = a*n,\n  return = a*(accumulate(r, \\(x, y) x*y) |> accumulate(\\(x, y) x + y)),\n) |> \n  ggplot()+\n  geom_line(aes(x = n, y = return), color = 'red')+\n  geom_col(aes(x = n, y = cost), alpha = .7)+\n  geom_line(aes(x = n, y = cost), color = 'blue')\n```\n\n::: {.cell-output-display}\n![](複利計算_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n## 利率がランダムウォークする場合\n\n- 景気は各時点でランダムに発生するわけではない\n- むしろ1時点前の状況を強く反映する\n- 利率がランダムウォークすると仮定する\n\n\\begin{align*}\n& r_1 \\sim \\mathrm{Normal}(1.05, 0.1) \\\\\n& r_{i + 1} = r_i + e_i, \\; e_i \\sim \\mathrm{Normal}(1.05, 0.1)\n\\end{align*}\n\n\\begin{align*}\n& 1年目:ar_1 \\\\\n& 2年目:ar_1 + ar_1r_2 = a(r_1 + r_1(r_1 + e_1))\\\\\n& 3年目:ar_1 + ar_1r_2 + ar_1r_2r_3 = a(r_1 + r_1(r_1 + e_1) + r_1(r_1 + e_1)(r_2 + e_2)) = a(r_1 + r_1(r_1 + e_1) + r_1(r_1 + e_1)(r_1 + e_1 + e_2))\\\\\n\\end{align*}\n\n\n",
    "supporting": [
      "複利計算_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}