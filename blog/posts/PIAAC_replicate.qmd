---
title: "手動で標準誤差を計算してみる（PIAAC）"
date: 2024-09-21
categories: [Others]
---

```{r}
#| eval: false
data |> 
  filter(countryid == 'Japan') |> 
  select(agegroup, sweight, matches('(literacy|jackweight)')) |> 
  pivot_longer(
    cols = matches('(literacy)'), 
    names_to = 'type', 
    values_to = 'literacy'
  ) |> 
  pivot_longer(
    cols = matches('(jackweight)'), 
    names_to = 'replicate', 
    values_to = 'jackweight'
  ) |> 
  relocate(agegroup, type, replicate) |> 
  summarise(
    mean = weighted.mean(literacy, sweight, na.rm = TRUE),
    mean_jack = weighted.mean(literacy, jackweight, na.rm = TRUE),
    .by = c(agegroup, type, replicate)
  ) |> 
  summarise(
    mean = mean(mean),
    variance = sqrt(sum((mean - mean_jack)^2)),
    .by = c(agegroup, type)
  ) |> 
  arrange(type, agegroup) |> 
  knitr::kable(digits = 4)


```

